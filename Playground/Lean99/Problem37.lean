/-
# å•é¡Œ 37
(ä¸­ç´š ðŸŒŸðŸŒŸ) ã‚ªã‚¤ãƒ©ãƒ¼ã®ãƒˆãƒ¼ã‚·ã‚§ãƒ³ãƒˆé–¢æ•° Ï†(m) ã‚’ï¼ˆæ”¹è‰¯ç‰ˆã§ï¼‰è¨ˆç®—ã›ã‚ˆã€‚

ã‚ªã‚¤ãƒ©ãƒ¼ã®ãƒˆãƒ¼ã‚·ã‚§ãƒ³ãƒˆé–¢æ•°ã®å®šç¾©ã¯[å•é¡Œ34](./Problem34.md)ã‚’å‚ç…§ã€‚ã‚‚ã—[å•é¡Œ36](./Problem36.md)ã®ã‚ˆã†ã«ç´ å› æ•°åˆ†è§£ã®ãƒªã‚¹ãƒˆãŒåˆ†ã‹ã£ã¦ã„ã‚Œã°ã€æ¬¡ã®å¼ã§åŠ¹çŽ‡çš„ã« Ï†(m) ã‚’è¨ˆç®—ã§ãã‚‹ï¼š

$$
Ï†(m) = âˆ_{i=1}^{n} (p_i - 1) * p_i^{(m_i - 1)}
$$
-/

/-- n ã®ç´ å› æ•°ã¨ãã®é‡è¤‡åº¦ã®ãƒªã‚¹ãƒˆåž‹ -/
abbrev PrimeFactor := List (Nat Ã— Nat)

def Ï† (_n : Nat) (factors : PrimeFactor) : Nat :=
  factors.foldl (fun acc (p, m) => acc * (p - 1) * p ^ (m - 1)) 1

#guard Ï† 10 [(2, 1), (5, 1)] == 4
#guard Ï† 20 [(2, 2), (5, 1)] == 8
#guard Ï† 39 [(3, 1), (13, 1)] == 24
